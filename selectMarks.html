<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Select Marks</title>

    <script type="module">
        // SelectionUpdateType is an enum for specifying the selection type for the select marks api.
        // TableauEventType represents the type of Tableau embedding event that can be listened for.
        // TODO: Replace when Public goes live with 22.3
        import { SelectionUpdateType, TableauEventType } from "https://cd-next-rel-public.online.vnext.tabint.net/javascripts/api/tableau.embedding.3.3.0.js";

        function handleFirstInteractive(e) {
            let sheet = viz.workbook.activeSheet;

            // Select Marks.
            const selectButton = document.getElementById("select");
            selectButton.onclick = async () => {
                const selections = [
                    {
                        fieldName: "College",
                        value: "Engineering",
                    },
                ];
                await sheet.selectMarksByValueAsync(
                    selections,
                    SelectionUpdateType.Replace
                );
            };

            // Add Marks to the Selection.
            const addButton = document.getElementById("add");
            addButton.onclick = async () => {
                const selections = [
                    {
                        fieldName: "College",
                        value: "Business",
                    },
                ];

                await sheet.selectMarksByValueAsync(selections, SelectionUpdateType.Add);
            };

            // Clear Marks.
            const clearButton = document.getElementById("clear");
            clearButton.onclick = async () => {
                await sheet.clearSelectedMarksAsync();
            };
        }

        const viz = document.getElementById("tableauViz");

        // Event fired when a viz first becomes interactive.
        viz.addEventListener(TableauEventType.FirstInteractive, handleFirstInteractive);
    </script>
</head>

<body>
    <div>
        <!-- Initialization of the Tableau visualization. -->
        <!-- TODO: Replace when Public goes live with 22.3 -->
        <tableau-viz id="tableauViz" src="https://cd-next-rel-public.online.vnext.tabint.net/views/RegionalSampleWorkbook/College"
            hide-tabs>
            <!-- TODO: Remove when Public goes live with 22.3 -->
            <custom-parameter name=":showVizHome" value="n"></custom-parameter>
        </tableau-viz>
    </div>
    <br />
    <!-- Buttons to handle selection. -->
    <button id="select">Select a value</button>
    <button id="add">Add to the selection</button>
    <button id="clear">Clear all</button>
</body>

</html>